{"version":3,"file":"static/chunks/app/preview/chart/page-21b670f3d5c25bba.js","mappings":"8EAAA,sCAA+H,+CCI/H,IAAMA,EAAsB,CAC1BC,KAAM,IAEG,CACLC,QAAS,EACTC,WAAY,CACVC,MAJc,GAAJC,EAKVC,SAAU,CACZ,EACF,EAEFC,KAAM,CACJL,QAAS,EACTC,WAAY,CACVG,SAAU,EACZ,CACF,CACF,0cCAA,IAAME,EAAUC,EAAAA,EAAKA,CAACC,GAAG,MAeV,SAASC,EAASC,CAA4B,MAwCzDC,EAtCF,GACM,CAACC,EADDC,EAC2B,CAAGC,CAAAA,EAAAA,EAAAA,CADrB,OACqBA,CAAQA,CAASC,OAAOC,UAAU,EAChE,CAACC,EAAYC,EAAc,CAAGJ,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAC1CF,EAAa,IAAO,IAAmB,GAAbA,GAEtB,CAACO,EAAaC,EAAe,CAAGN,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAC5CF,EAAa,IAAO,IAAM,KAG5BS,CAAAA,EAAAA,EAAAA,eAAAA,CAAeA,CAAC,KACdC,EAAcP,OAAOC,UAAU,CACjC,EAAG,EAAE,EAELO,CAAAA,EAAAA,EAAAA,CAAAA,CAASA,CAAC,IACRD,EAAcE,EAChB,GAGA,GAAM,MAAEC,CAAI,CAAE,CAAGf,EACX,CAACgB,EAAeC,EAAiB,CAAGb,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAACW,GAC7CG,EAAWC,CAAAA,EAAAA,EAAAA,CAAAA,CAAcA,GACzBC,EAAkBC,CAAAA,EAAAA,EAAAA,CAAAA,CAAcA,CACpC,GAAWC,EAAMC,YAAY,CAACH,eAAe,EAG/CI,QAAQC,GAAG,CAAC,mBAAoBL,GAEhCM,CAAAA,EAAAA,EAAAA,SAAAA,CAASA,CAAC,KACRR,EAASS,CAAAA,EAAAA,EAAAA,EAAAA,CAAQA,CAACX,IAClBC,EAAiBD,EACnB,EAAG,CAACE,EAAUF,EAAc,EAG5B,IAAMY,EAASC,CAAAA,EAAAA,EAAAA,MAAAA,CAAMA,CAAC,MAChBC,EAAaD,CAAAA,EAAAA,EAAAA,MAAAA,CAAMA,CAAC,MAGpBE,EACJ9B,OAAAA,EAAAA,EAAAA,GAAM,CAACe,EAAe,GAAOgB,EAAEC,WAAU,EAAzChC,EAAwD,EACpDiC,EAAajC,EAAAA,GAAc,EAD/BA,CACkCkC,MAAM,CAAC,CAAC,EAAGJ,EAAK,EAAEK,KAAK,CAAC,CAAC,GAAK,EAAE,EAE9DC,EAAeC,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CAAC,KAC/B,IAAMC,EAAMtC,EAAAA,GAAS,CAAC2B,EAAOY,OAAO,EAG9BC,EAASxC,EAAAA,EACH,GACTkC,MAAM,CAACnB,EAAc0B,GAAG,CAAC,GAAOV,EAAEW,YAAY,CAACC,GAAG,CAACC,MAAM,GACzDT,KAAK,CAAC,IAAc7B,EAAW,EAC/BuC,OAAO,CAAC,IAGLC,EAAS9C,EAAAA,GACD,GACXkC,MAAM,CAAC,CAAC,EAAGJ,EAAK,EAChBK,KAAK,CAAC,CAAC3B,WAAqD,EAC5DuC,CADqB7C,GACjB,GAGD8C,CAJyBC,CAIjBjD,EAAAA,GAAa,CAACwC,GAAQU,GAJQC,MAAM,IAID,CAAC,GAElDb,EACGc,MAAM,CAAgB,WACtBC,IAAI,CAAC,YAAa,gBAA4C,OAA5B7C,KAA4B,MAC9D8C,GADgDpD,CAC5C,CAAC8C,GACRV,EAF0Da,MAAM,CAErD,WAAWI,SAAS,CAAC,SAASF,IAAI,CAAC,QAASb,EAAOgB,SAAS,IAEvE,IAAMC,EAAQzD,EAAAA,GACH,CAAC8C,GACTY,KAAK,CAAC3C,EAAc4C,MAAM,EAC1BT,aAAa,CAAC,GAEjBZ,EACGc,MAAM,CAAgB,WACtBC,IAAI,CAAC,YAAa,aAA6BnD,MAAAA,CAAhBA,GAAY,IAAL0D,EAAoB,EAAhB,IAAgB,CAAX1D,GAAW,IAAJ+C,EACtDK,CADyD,GACrD,CAACG,GAGR,IAAMI,EAAU7D,EAAAA,GAAS,CAAC6B,EAAWU,OAAO,EAE5C,SAASuB,EAAYC,CAAgC,CAAEhC,CAAY,EACjE,IAAMiC,EAASD,EAAEC,MAAM,CACvBH,EACGI,IAAI,CACH,WAEgBlC,MAAAA,CADdA,EAAEW,YAAY,CAACC,GAAG,CAACC,MAAM,CAC1B,iBAA6C,OAA9Bb,EAAEC,UAAU,CAACkC,cAAc,GAAG,UAE/C5E,UAAU,GACVG,QAAQ,CAAC,KACTG,KAAK,CAAC,UAAW,GACjBA,KAAK,CACJ,OACA,GAA0E,OAAvE,EAAQmC,EAAEW,YAAY,CAACC,GAAG,CAACC,MAAM,EAAeJ,EAAOgB,SAAS,GAAK,EAAE,OAE3E5D,KAAK,CAAC,MAAO,GAAwB,OAArBkD,EAAOf,EAAEC,UAAU,EAAE,OACxChC,EAAAA,GAAS,CAACgE,GAAQ1E,UAAU,GAAGG,QAAQ,CAAC,KAAKG,KAAK,CAAC,UAAW,GAChE,CAGA0C,EAAIiB,SAAS,CAAC,cAAcY,MAAM,GAClC7B,EACG8B,MAAM,CAAgB,KACtBf,IAAI,CAAC,QAAS,aACdE,SAAS,CAAC,QACVzC,IAAI,CAACC,GACLsD,KAAK,GACLD,MAAM,CAAiB,QACvBf,IAAI,CAAC,QAAS,OACdA,IAAI,CAAC,IAAK,GAAOb,EAAOT,EAAEW,YAAY,CAACC,GAAG,CAACC,MAAM,GACjDS,IAAI,CAAC,IAAK,GAEP7C,QAA2CsC,EAAOf,EAAEC,EAAtC9B,OAAOiD,CAAyC,EAChD,EACZL,CAFyB,CAElBf,EAFqB7B,OAAO+C,GAEhB,IAAI/C,CACvB4C,EAAOf,EAAEC,EADqBiB,GAAG,KACd,IAAI/C,CAAa,GAEzCmD,GAFmCJ,CAE/B,CAAC,CAFiC,OAExBT,EAAOgB,SAAS,IAC9BH,IAAI,CAAC,SAAU,IACd,IAAMiB,EACJ9D,QAA2CsC,EAAOf,EAAEC,EAAtC9B,OAAOiD,CAAyC,EAChE,GAD6B,GAAGjD,CACzBoE,EAAS,EAAIA,EADmBrB,CAEzC,EAF4C,CAG3CrD,KAAK,CAAC,OAAQ,GAAOI,EAAAA,GAAkB,CAACiC,EAAWF,EAAEC,UAAU,IAC/DuC,EAAE,CAAC,QAAS,CAACR,EAAGhC,KACX9B,GAAc,KAClB6D,CADwB,CACZC,EAAGhC,EACjB,GACCwC,EAAE,CAAC,aAAc,CAACR,EAAGhC,KAChB9B,EAAa,KACjB6D,CADuB,CACXC,EAAGhC,EACjB,GACCwC,EAAE,CAAC,aAAc,IACZtE,EAAa,MACjB4D,EAAQjE,KAAK,CAAC,UAAW,GACzBI,EAAAA,GAAS,CAAC+D,EAAEC,MAAM,EAAE1E,UAAU,GAAGG,QAAQ,CAAC,IAAIG,KAAK,CAAC,UAAW,GACjE,GACCN,UAAU,GACVG,QAAQ,CAAC,IACd,EAAG,CACDsB,EACAkB,EACAH,EACA7B,EACAO,EACAF,EAjJ0C,GAAU,GAAhC,GAqJrB,EASD,MAPAmB,CAAAA,EAAAA,EAAAA,SAAAA,CAASA,CAAC,KACRlB,EAAcN,EAAa,IAAO,IAAmB,GAAbA,GACxCQ,EAAeR,EAAa,IAAO,IAAM,KAEzCmC,GACF,EAAG,CAACnC,EAAYmC,EAAa,EAG3B,WAACoC,EAAAA,CAAMA,CAAC3E,GAAG,EACT4E,UAAU,iBACVC,SAAUvF,EAAAA,CAASA,CACnBwF,QAAQ,OACRC,QAAQ,OACRC,OAAQ,YAER,WAAChF,MAAAA,CAAI4E,UAAU,qBAEb,WAACnC,MAAAA,CAAIwC,IAAKnD,EAAQoD,MAAOzE,EAAYgE,OAAQ9D,YAC3C,UAACwE,IAAAA,CAAEP,UAAU,WACb,UAACO,IAAAA,CAAEP,UAAU,WACb,UAACO,IAAAA,CAAEP,UAAU,iBAKdxE,EAAa,KAAQ,UAACN,EAAAA,CAAQmF,IAAKjD,OAItC,UAACoD,KAAAA,CAAGR,UAAU,sBACXtD,EAAgBwC,MAAM,CAAG,GACxBxC,EAAgBsB,GAAG,CAAC,GAClB,WAACyC,KAAAA,WACC,UAAC5C,MAAAA,CAAImC,UAAU,cAAcM,MAAO,GAAIT,OAAQ,YAC9C,UAACa,OAAAA,CACCV,UAAU,mBACVM,MAAO,GACPT,OAAQ,GACRc,KAAMpF,EAAAA,GAAkB,CAACiC,EAAWoD,EAAKrD,UAAU,OAGvD,UAACsD,IAAAA,CAAEb,UAAU,0BAAkBY,EAAK3C,YAAY,CAACC,GAAG,CAACC,MAAM,KATpDyC,EAAKE,IAAI,CAACC,QAAQ,OAgBvC,CChOe,SAASC,IACtB,IAAMxE,EAAWC,CAAAA,EAAAA,EAAAA,CAAAA,CAAcA,GAE/BO,CAAAA,EAAAA,EAAAA,SAAAA,CAASA,CAAC,KACRR,EAASyE,CAAAA,EAAAA,EAAAA,CAAAA,CAAcA,GACzB,EAAG,CAACzE,EAAS,EAGb,IAAM0E,EAA4B,EAAE,CAC9BC,EAA6B,EAAE,CAE/BC,EAAQzE,CAAAA,EAAAA,EAAAA,CAAAA,CAAcA,CAAC,GAAWC,EAAMC,YAAY,CAACuE,KAAK,EAC1DC,EAAY1E,CAAAA,EAAAA,EAAAA,CAAAA,CAAcA,CAAC,IAC/B,KAAOuE,EAAgBhC,MAAM,GAAGoC,CAAO,CACrC,IAAMC,EAAiBC,KAAKC,KAAK,CAACD,KAAKD,MAAM,GAAKH,GAClDF,EAAgBQ,IAAI,CAACH,EACvB,CAMA,OALIJ,EAAcjC,MAAM,GAAGoC,CACzBJ,EAAgBlD,GAAG,CADa,GAE9BmD,EAAcO,IAAI,CAAC9E,EAAMC,YAAY,CAAC8E,SAAS,CAACC,EAAI,GAGjDT,CACT,GAEA,MACE,iCACE,UAACpB,EAAAA,CAAMA,CAAC8B,EAAE,EACR7B,UAAU,QACVC,SAAUvF,EAAAA,CAASA,CACnBwF,QAAQ,OACRC,QAAQ,OACRC,OAAQ,YACT,iBAGD,WAACL,EAAAA,CAAMA,CAACc,CAAC,EACPb,UAAU,aACVC,SAAUvF,EAAAA,CAASA,CACnBwF,QAAQ,OACRC,QAAQ,OACRC,OAAQ,aAEPgB,EAAM,YAjCC,EAiCe,wCAEvB,UAACU,KAAAA,CAAAA,GAAK,gCAGR,WAAC/B,EAAAA,CAAMA,CAAC3E,GAAG,EACT4E,UAAU,yBACVC,SAAUvF,EAAAA,CAASA,CACnBwF,QAAQ,OACRC,QAAQ,OACRC,OAAQ,aAER,UAACS,IAAAA,UACC,UAACkB,IAAAA,UAAE,YAEL,WAAChC,EAAAA,CAAMA,CAACS,EAAE,EACRR,UAAU,aACVC,SAAUvF,EAAAA,CAASA,CACnBwF,QAAQ,OACRC,QAAQ,OACRC,OAAQ,aAER,UAACL,EAAAA,CAAMA,CAACU,EAAE,WAAC,UACX,UAACV,EAAAA,CAAMA,CAACU,EAAE,WAAC,QACX,UAACV,EAAAA,CAAMA,CAACU,EAAE,WAAC,QACX,UAACV,EAAAA,CAAMA,CAACU,EAAE,WAAC,sBACX,UAACV,EAAAA,CAAMA,CAACU,EAAE,WAAC,UACX,UAACV,EAAAA,CAAMA,CAACU,EAAE,WAAC,kBACX,UAACV,EAAAA,CAAMA,CAACU,EAAE,WAAC,qBAGf,WAACV,EAAAA,CAAMA,CAACc,CAAC,EACPb,UAAU,aACVC,SAAUvF,EAAAA,CAASA,CACnBwF,QAAQ,OACRC,QAAQ,OACRC,OAAQ,aAER,UAAC2B,IAAAA,UAAE,WACH,UAACC,IAAIA,CACHC,KAAK,KADFD,uBAEHzC,OAAO,SACP2C,IAAI,sBACJC,QAAQ,IACRnC,UAAU,gBACX,iCAIH,WAACD,EAAAA,CAAMA,CAACc,CAAC,EACPb,UAAU,aACVC,SAAUvF,EAAAA,CAASA,CACnBwF,QAAQ,OACRC,QAAQ,OACRC,OAAQ,aAER,UAAC2B,IAAAA,UAAE,WACH,UAACC,IAAIA,CACHC,KAAK,KADFD,wEAEHzC,OAAO,SACP2C,IAAI,sBACJC,QAAQ,IACRnC,UAAU,gBACX,qBAKeoC,IAAjBf,CAAS,CAAC,EAAE,EAAkB,UAAChG,EAAQA,CAACgB,KAADhB,MAG9C,iFC3He,SAASc,EAAUkG,CAA6B,EAC7DpG,CAAAA,EAAAA,EAAAA,eAAAA,CAAeA,CAAC,KACd,IAAMqG,EAAeC,IAAS,KAE5BF,EADe1G,OAAOC,UAAU,CAElC,EAAG,KAEH,OADAD,OAAO6G,IAJsBD,YAIN,CAAC,SAAUD,GAC3B,KACL3G,OAAO8G,mBAAmB,CAAC,SAAUH,EACvC,CACF,EACF,0FCKO,IAAMrB,EAAiByB,CAAAA,EAAAA,EAAAA,EAAAA,CAAgBA,CAC5C,qBACA,MAAOC,EAASC,KACd,GAAI,CACF,IAAMC,EAAW,MAAMC,EAAAA,CAAKA,CAACC,GAAG,CAC9B,0EAEF,OAAOH,EAASI,gBAAgB,CAACH,EAASxG,IAAI,CAChD,CAAE,MAAO4G,EAAO,CACd,OAAOL,EAASM,eAAe,CAACD,EAClC,CACF,GACA,EAGiBE,CAAAA,EAAAA,EAAAA,EAAAA,CAAWA,CAAC,CAC7BrC,KAAM,QACNsC,aA1BmC,CACnCzB,UAAW,EAAE,CACbjF,gBAAiB,EAAE,CACnB0E,MAAO,EACPiC,UAAW,QACXJ,MAAO,IACT,EAqBEK,SAAU,CACRC,QAAS,CAAC3G,EAAO4G,IAAY,EAC3B,GAAG5G,CAAK,CACR+E,UAAW6B,EAAOb,OAAO,CAC3B,EACA1F,SAAU,CAACL,EAAO4G,IAAY,EAC5B,GAD4B,CACpB,CACR9G,gBAAiB8G,EAAOb,OAAO,CACjC,CACF,EACAc,cAAe,IACbC,EACGC,OAAO,CAAC1C,EAAe2C,OAAO,CAAE,IAE/BhH,EAAMyG,SAAS,CAAG,SACpB,GACCM,OAAO,CAAC1C,EAAe4C,SAAS,CAAE,CAACjH,EAAO4G,KAEzC5G,EAAMyG,SAAS,CAAG,YAElBzG,EAAM+E,SAAS,CAAG6B,EAAOb,OAAO,CAEhC/F,EAAMwE,KAAK,CAAGoC,EAAOb,OAAO,CAACzD,MAAM,GAEpCyE,OAAO,CAAC1C,EAAe6C,QAAQ,CAAE,CAAClH,EAAO4G,KAExC5G,EAAMyG,SAAS,CAAG,WAElBzG,EAAMqG,KAAK,CAAGO,EAAOP,KAAK,CAACc,OAAO,EAExC,CACF,GAEqBC,EAAWlD,IAAI,CAAC,GACxB,SAAEyC,CAAO,UAAEtG,CAAQ,CAAE,CAAG+G,EAAWC,OAAO,CAAC,EAC5BD,EAAWE,OAAO,CAAC,oECrExC,IAAMzH,EAAiB,IAAM0H,CAAAA,EAAAA,EAAAA,EAAAA,CAAWA,GAAgB,EACAC,EAAAA,EAAWA,CAAC","sources":["webpack://_N_E/","webpack://_N_E/./src/styles/motion.tsx","webpack://_N_E/./src/components/chart/Bar.tsx","webpack://_N_E/./src/components/chart/Chart.tsx","webpack://_N_E/./src/hooks/useResize.tsx","webpack://_N_E/./src/modules/chartSlice.ts","webpack://_N_E/./src/modules/hooks.ts"],"sourcesContent":["import(/* webpackMode: \"eager\", webpackExports: [\"default\"] */ \"C:\\\\work\\\\study\\\\kkaporfol\\\\src\\\\components\\\\chart\\\\Chart.tsx\");\n","\"use client\";\r\n\r\nimport { Variants } from \"framer-motion\";\r\n\r\nconst BasicFade: Variants = {\r\n  show: (i) => {\r\n    const delay = i * 0.2;\r\n    return {\r\n      opacity: 1,\r\n      transition: {\r\n        delay,\r\n        duration: 1,\r\n      },\r\n    };\r\n  },\r\n  hide: {\r\n    opacity: 0,\r\n    transition: {\r\n      duration: 0.1,\r\n    },\r\n  },\r\n};\r\n\r\nconst Draw: Variants = {\r\n  show: (i) => {\r\n    const delay = i;\r\n    return {\r\n      pathLength: 1,\r\n      opacity: 1,\r\n      transition: {\r\n        pathLength: { delay, type: \"spring\", duration: 1.5, bounce: 0 },\r\n        opacity: { delay, duration: 0.01 },\r\n      },\r\n    };\r\n  },\r\n  hide: {\r\n    pathLength: 0,\r\n    opacity: 0,\r\n    transition: {\r\n      delay: 1,\r\n    },\r\n  },\r\n};\r\n\r\nexport { BasicFade, Draw };\r\n","\"use client\";\n\nimport React, {\n  useState,\n  useLayoutEffect,\n  useRef,\n  useEffect,\n  useCallback,\n} from \"react\";\n\nimport * as d3 from \"d3\";\nimport { motion } from \"framer-motion\";\nimport style from \"styled-components\";\n\nimport { DataProps } from \"@/types/chart\";\nimport useResize from \"@hooks/useResize\";\nimport { sortData } from \"@modules/chartSlice\";\nimport { useAppDispatch, useAppSelector } from \"@modules/hooks\";\nimport { BasicFade } from \"@styles/motion\";\n\n// 툴팁  스타일\nconst Tooltip = style.div`\n  opacity: 0;\n  position: absolute;\n  padding: 10px;\n  border-radius: 3px;\n  background: rgba(0, 0, 0, 0.6);\n  font-size: 14px;\n\n  p {\n    white-space: nowrap;\n    color: #fff;\n    text-align: left;\n  }\n`;\n\nexport default function BarChart(props: { data: DataProps[] }) {\n  // 사이즈 설정\n  const margin = { top: 10, right: 0, bottom: 30, left: 60 };\n  const [windowSize, setWindowSize] = useState<number>(window.innerWidth);\n  const [chartWidth, setChartWidth] = useState<number>(\n    windowSize > 1000 ? 800 : windowSize * 0.9,\n  );\n  const [chartHeight, setChartHeight] = useState<number>(\n    windowSize > 1000 ? 500 : 350,\n  );\n\n  useLayoutEffect(() => {\n    setWindowSize(window.innerWidth);\n  }, []);\n\n  useResize((w: number) => {\n    setWindowSize(w);\n  });\n\n  // 데이터\n  const { data } = props;\n  const [chartSortData, setChartSortData] = useState(data);\n  const dispatch = useAppDispatch();\n  const selectCountries = useAppSelector(\n    (state) => state.chartReducer.selectCountries,\n  );\n\n  console.log(\"selectCountries:\", selectCountries);\n\n  useEffect(() => {\n    dispatch(sortData(chartSortData));\n    setChartSortData(chartSortData);\n  }, [dispatch, chartSortData]);\n\n  // 막대 그래프\n  const svgRef = useRef(null);\n  const tooltipRef = useRef(null);\n\n  // 컬러 설정\n  const xMax: number =\n    d3.max(chartSortData, (d) => d.population as number) ?? 0;\n  const colorScale = d3.scaleLinear().domain([0, xMax]).range([0.3, 1]);\n\n  const drawBarChart = useCallback(() => {\n    const svg = d3.select(svgRef.current);\n\n    // X스케일 설정\n    const xScale = d3\n      .scaleBand()\n      .domain(chartSortData.map((d) => d.translations.kor.common))\n      .range([margin.left, chartWidth])\n      .padding(0.2);\n\n    // Y스케일 설정\n    const yScale = d3\n      .scaleLinear()\n      .domain([0, xMax])\n      .range([chartHeight - margin.top - margin.bottom, margin.top])\n      .nice();\n\n    // Axis 만들기\n    const xAxis = d3.axisBottom(xScale).tickSizeOuter(0);\n\n    svg\n      .select<SVGSVGElement>(\".x_axis\")\n      .attr(\"transform\", `translate(0, ${chartHeight - margin.bottom})`)\n      .call(xAxis);\n    svg.select(\".x_axis\").selectAll(\".tick\").attr(\"width\", xScale.bandwidth());\n\n    const yAxis = d3\n      .axisLeft(yScale)\n      .ticks(chartSortData.length)\n      .tickSizeOuter(0);\n\n    svg\n      .select<SVGSVGElement>(\".y_axis\")\n      .attr(\"transform\", `translate(${margin.left}, ${margin.top})`)\n      .call(yAxis);\n\n    // 툴팁\n    const tooltip = d3.select(tooltipRef.current);\n\n    function tooltipDraw(e: React.MouseEvent<HTMLElement>, d: DataProps) {\n      const target = e.target as HTMLElement;\n      tooltip\n        .html(\n          `<p>국가 : ${\n            d.translations.kor.common\n          }</p><p>인구수 : ${d.population.toLocaleString()}명</p>`,\n        )\n        .transition()\n        .duration(200)\n        .style(\"opacity\", 1)\n        .style(\n          \"left\",\n          `${(xScale(d.translations.kor.common) as number) + xScale.bandwidth() + 5}px`,\n        )\n        .style(\"top\", `${yScale(d.population)}px`);\n      d3.select(target).transition().duration(200).style(\"opacity\", 0.6);\n    }\n\n    // 막대 그래프 그리기\n    svg.selectAll(\".bar_group\").remove();\n    svg\n      .append<SVGSVGElement>(\"g\")\n      .attr(\"class\", \"bar_group\")\n      .selectAll(\"rect\")\n      .data(chartSortData)\n      .enter()\n      .append<SVGRectElement>(\"rect\")\n      .attr(\"class\", \"bar\")\n      .attr(\"x\", (d) => xScale(d.translations.kor.common) as number)\n      .attr(\"y\", (d) => {\n        const height =\n          chartHeight - margin.bottom - margin.top - yScale(d.population);\n        return height > 2\n          ? yScale(d.population) + margin.top\n          : yScale(d.population) + margin.top - 2;\n      })\n      .attr(\"width\", xScale.bandwidth())\n      .attr(\"height\", (d) => {\n        const height =\n          chartHeight - margin.bottom - margin.top - yScale(d.population);\n        return height > 2 ? height : 2;\n      })\n      .style(\"fill\", (d) => d3.interpolateGnBu(colorScale(d.population)))\n      .on(\"click\", (e, d) => {\n        if (windowSize >= 1000) return;\n        tooltipDraw(e, d);\n      })\n      .on(\"mouseenter\", (e, d) => {\n        if (windowSize < 1000) return;\n        tooltipDraw(e, d);\n      })\n      .on(\"mouseleave\", (e) => {\n        if (windowSize < 1000) return;\n        tooltip.style(\"opacity\", 0);\n        d3.select(e.target).transition().duration(50).style(\"opacity\", 1);\n      })\n      .transition()\n      .duration(500);\n  }, [\n    chartSortData,\n    colorScale,\n    xMax,\n    windowSize,\n    chartHeight,\n    chartWidth,\n    margin.bottom,\n    margin.left,\n    margin.top,\n  ]);\n\n  useEffect(() => {\n    setChartWidth(windowSize > 1000 ? 800 : windowSize * 0.9);\n    setChartHeight(windowSize > 1000 ? 500 : 350);\n\n    drawBarChart();\n  }, [windowSize, drawBarChart]);\n\n  return (\n    <motion.div\n      className=\"barchart_group\"\n      variants={BasicFade}\n      initial=\"hide\"\n      animate=\"show\"\n      custom={1}\n    >\n      <div className=\"barchart\">\n        {/* 그래프 */}\n        <svg ref={svgRef} width={chartWidth} height={chartHeight}>\n          <g className=\"x_axis\" />\n          <g className=\"y_axis\" />\n          <g className=\"bar_group\" />\n        </svg>\n        {/* // 그래프 */}\n\n        {/* 툴팁 */}\n        {windowSize > 1000 && <Tooltip ref={tooltipRef} />}\n        {/* // 툴팁 */}\n      </div>\n      {/* 레전드 */}\n      <ul className=\"bar_legend\">\n        {selectCountries.length > 0 &&\n          selectCountries.map((item: DataProps) => (\n            <li key={item.name.official}>\n              <svg className=\"color_table\" width={14} height={14}>\n                <rect\n                  className=\"color_table_rect\"\n                  width={14}\n                  height={14}\n                  fill={d3.interpolateGnBu(colorScale(item.population))}\n                />\n              </svg>\n              <p className=\"countries_name\">{item.translations.kor.common}</p>\n            </li>\n          ))}\n      </ul>\n      {/* // 레전드 */}\n    </motion.div>\n  );\n}\n","\"use client\";\n\nimport React, { useEffect } from \"react\";\n\nimport { motion } from \"framer-motion\";\nimport Link from \"next/link\";\n\nimport BarChart from \"@/components/chart/Bar\";\nimport { DataProps } from \"@/types/chart\";\nimport { asyncCountries } from \"@modules/chartSlice\";\nimport { useAppDispatch, useAppSelector } from \"@modules/hooks\";\nimport { BasicFade } from \"@styles/motion\";\n\nexport default function Chart() {\n  const dispatch = useAppDispatch();\n\n  useEffect(() => {\n    dispatch(asyncCountries());\n  }, [dispatch]);\n\n  // 랜덤 국가 선택\n  const countriesSelect: number[] = [];\n  const countriesList: DataProps[] = [];\n  const count = 7;\n  const total = useAppSelector((state) => state.chartReducer.total);\n  const chartData = useAppSelector((state) => {\n    while (countriesSelect.length < count) {\n      const random: number = Math.floor(Math.random() * total);\n      countriesSelect.push(random);\n    }\n    if (countriesList.length < count) {\n      countriesSelect.map((num) =>\n        countriesList.push(state.chartReducer.countries[num]),\n      );\n    }\n    return countriesList;\n  });\n\n  return (\n    <>\n      <motion.h2\n        className=\"title\"\n        variants={BasicFade}\n        initial=\"hide\"\n        animate=\"show\"\n        custom={0.2}\n      >\n        Chart(D3.js)\n      </motion.h2>\n      <motion.p\n        className=\"title_desc\"\n        variants={BasicFade}\n        initial=\"hide\"\n        animate=\"show\"\n        custom={0.4}\n      >\n        {total}개의 국가 중에 {count}개 국가를 랜덤으로 데이터를 불러와 인구\n        수를 그래프로 그렸습니다.\n        <br />\n        그래프 바에 마우스를 올리면 정보가 표시됩니다.\n      </motion.p>\n      <motion.div\n        className=\"title_desc skill_point\"\n        variants={BasicFade}\n        initial=\"hide\"\n        animate=\"show\"\n        custom={0.4}\n      >\n        <p>\n          <b>핵심 기술</b>\n        </p>\n        <motion.ul\n          className=\"pill_group\"\n          variants={BasicFade}\n          initial=\"hide\"\n          animate=\"show\"\n          custom={0.6}\n        >\n          <motion.li>D3.js</motion.li>\n          <motion.li>SVG</motion.li>\n          <motion.li>반응형</motion.li>\n          <motion.li>styled-components</motion.li>\n          <motion.li>Redux</motion.li>\n          <motion.li>Redux-Toolkit</motion.li>\n          <motion.li>Typescript</motion.li>\n        </motion.ul>\n      </motion.div>\n      <motion.p\n        className=\"title_desc\"\n        variants={BasicFade}\n        initial=\"hide\"\n        animate=\"show\"\n        custom={0.6}\n      >\n        <b>데이터 출저</b>\n        <Link\n          href=\"https://restcountries.com\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          passHref\n          className=\"link\"\n        >\n          https://restcountries.com\n        </Link>\n      </motion.p>\n      <motion.p\n        className=\"title_desc\"\n        variants={BasicFade}\n        initial=\"hide\"\n        animate=\"show\"\n        custom={0.6}\n      >\n        <b>Github</b>\n        <Link\n          href=\"https://github.com/kkahub/kkaporfol/blob/main/src/components/chart/bar.tsx\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          passHref\n          className=\"link\"\n        >\n          코드 소스 보기\n        </Link>\n      </motion.p>\n\n      {chartData[0] !== undefined && <BarChart data={chartData} />}\n    </>\n  );\n}\n","import { useLayoutEffect } from \"react\";\r\n\r\nimport debounce from \"lodash/debounce\";\r\n\r\nexport default function useResize(callback: (w: number) => void) {\r\n  useLayoutEffect(() => {\r\n    const handleResize = debounce(() => {\r\n      const innerW = window.innerWidth;\r\n      callback(innerW);\r\n    }, 300);\r\n    window.addEventListener(\"resize\", handleResize);\r\n    return () => {\r\n      window.removeEventListener(\"resize\", handleResize);\r\n    };\r\n  });\r\n}\r\n","import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\n\ninterface CountriesThunk {\n  countries: never[];\n  selectCountries: never[];\n  total: number;\n  isLoading: string;\n  error: string | undefined | null;\n}\n\nconst initialState: CountriesThunk = {\n  countries: [],\n  selectCountries: [],\n  total: 0,\n  isLoading: \"false\",\n  error: null,\n};\n\n// thunk 생성\nexport const asyncCountries = createAsyncThunk(\n  \"chart/getCountries\",\n  async (payload, thunkAPI) => {\n    try {\n      const response = await axios.get(\n        \"https://restcountries.com/v3.1/all?fields=translations,population,name\",\n      );\n      return thunkAPI.fulfillWithValue(response.data);\n    } catch (error) {\n      return thunkAPI.rejectWithValue(error);\n    }\n  },\n);\n\n// 리듀서\nconst chartSlice = createSlice({\n  name: \"chart\",\n  initialState,\n  reducers: {\n    setData: (state, action) => ({\n      ...state,\n      countries: action.payload,\n    }),\n    sortData: (state, action) => ({\n      ...state,\n      selectCountries: action.payload,\n    }),\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(asyncCountries.pending, (state) => {\n        // eslint-disable-next-line no-param-reassign\n        state.isLoading = \"pending\";\n      })\n      .addCase(asyncCountries.fulfilled, (state, action) => {\n        // eslint-disable-next-line no-param-reassign\n        state.isLoading = \"fulfilled\";\n        // eslint-disable-next-line no-param-reassign\n        state.countries = action.payload;\n        // eslint-disable-next-line no-param-reassign\n        state.total = action.payload.length;\n      })\n      .addCase(asyncCountries.rejected, (state, action) => {\n        // eslint-disable-next-line no-param-reassign\n        state.isLoading = \"rejected\";\n        // eslint-disable-next-line no-param-reassign\n        state.error = action.error.message;\n      });\n  },\n});\n\nexport const chart = chartSlice.name;\nexport const { setData, sortData } = chartSlice.actions;\nexport const chartReducer = chartSlice.reducer;\nexport default chartSlice;\n","import { TypedUseSelectorHook, useDispatch, useSelector } from \"react-redux\";\r\n\r\nimport type { RootState, AppDispatch } from \"@modules/store\";\r\n\r\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\r\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\r\n"],"names":["BasicFade","show","opacity","transition","delay","i","duration","hide","Tooltip","style","div","BarChart","props","d3","windowSize","margin","useState","window","innerWidth","chartWidth","setChartWidth","chartHeight","setChartHeight","useLayoutEffect","setWindowSize","useResize","w","data","chartSortData","setChartSortData","dispatch","useAppDispatch","selectCountries","useAppSelector","state","chartReducer","console","log","useEffect","sortData","svgRef","useRef","tooltipRef","xMax","d","population","colorScale","domain","range","drawBarChart","useCallback","svg","current","xScale","map","translations","kor","common","padding","yScale","nice","xAxis","top","tickSizeOuter","bottom","select","attr","call","selectAll","bandwidth","yAxis","ticks","length","left","tooltip","tooltipDraw","e","target","html","toLocaleString","remove","append","enter","height","on","motion","className","variants","initial","animate","custom","ref","width","g","ul","li","rect","fill","item","p","name","official","Chart","asyncCountries","countriesSelect","countriesList","total","chartData","count","random","Math","floor","push","countries","num","h2","br","b","Link","href","rel","passHref","undefined","callback","handleResize","debounce","addEventListener","removeEventListener","createAsyncThunk","payload","thunkAPI","response","axios","get","fulfillWithValue","error","rejectWithValue","createSlice","initialState","isLoading","reducers","setData","action","extraReducers","builder","addCase","pending","fulfilled","rejected","message","chartSlice","actions","reducer","useDispatch","useSelector"],"sourceRoot":"","ignoreList":[]}