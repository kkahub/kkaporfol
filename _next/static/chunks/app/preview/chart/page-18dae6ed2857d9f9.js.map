{"version":3,"file":"static/chunks/app/preview/chart/page-18dae6ed2857d9f9.js","mappings":"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","sources":["webpack://_N_E/","webpack://_N_E/./src/styles/motion.tsx","webpack://_N_E/./src/components/chart/bar.tsx","webpack://_N_E/./src/components/chart/Chart.tsx","webpack://_N_E/./src/hooks/useResize.tsx","webpack://_N_E/./src/modules/chartSlice.ts","webpack://_N_E/./src/modules/hooks.ts"],"sourcesContent":["import(/* webpackMode: \"eager\", webpackExports: [\"default\"] */ \"C:\\\\work\\\\study\\\\kkaporfol\\\\src\\\\components\\\\chart\\\\Chart.tsx\");\n","\"use client\";\r\n\r\nimport { Variants } from \"framer-motion\";\r\n\r\nconst BasicFade: Variants = {\r\n  show: (i) => {\r\n    const delay = i * 0.2;\r\n    return {\r\n      opacity: 1,\r\n      transition: {\r\n        delay,\r\n        duration: 1,\r\n      },\r\n    };\r\n  },\r\n  hide: {\r\n    opacity: 0,\r\n    transition: {\r\n      duration: 0.1,\r\n    },\r\n  },\r\n};\r\n\r\nconst Draw: Variants = {\r\n  show: (i) => {\r\n    const delay = i;\r\n    return {\r\n      pathLength: 1,\r\n      opacity: 1,\r\n      transition: {\r\n        pathLength: { delay, type: \"spring\", duration: 1.5, bounce: 0 },\r\n        opacity: { delay, duration: 0.01 },\r\n      },\r\n    };\r\n  },\r\n  hide: {\r\n    pathLength: 0,\r\n    opacity: 0,\r\n    transition: {\r\n      delay: 1,\r\n    },\r\n  },\r\n};\r\n\r\nexport { BasicFade, Draw };\r\n","\"use client\";\n\nimport React, {\n  useState,\n  useLayoutEffect,\n  useRef,\n  useEffect,\n  useCallback,\n} from \"react\";\n\nimport * as d3 from \"d3\";\nimport { motion } from \"framer-motion\";\nimport style from \"styled-components\";\n\nimport { DataProps } from \"@/types/chart\";\nimport useResize from \"@hooks/useResize\";\nimport { sortData } from \"@modules/chartSlice\";\nimport { useAppDispatch, useAppSelector } from \"@modules/hooks\";\nimport { BasicFade } from \"@styles/motion\";\n\n// 툴팁  스타일\nconst Tooltip = style.div`\n  opacity: 0;\n  position: absolute;\n  padding: 10px;\n  border-radius: 3px;\n  background: rgba(0, 0, 0, 0.6);\n  font-size: 14px;\n\n  p {\n    white-space: nowrap;\n    color: #fff;\n    text-align: left;\n  }\n`;\n\nexport default function BarChart(props: { data: DataProps[] }) {\n  // 사이즈 설정\n  const margin = { top: 10, right: 0, bottom: 30, left: 60 };\n  const [windowSize, setWindowSize] = useState<number>(window.innerWidth);\n  const [chartWidth, setChartWidth] = useState<number>(\n    windowSize > 1000 ? 800 : windowSize * 0.9,\n  );\n  const [chartHeight, setChartHeight] = useState<number>(\n    windowSize > 1000 ? 500 : 350,\n  );\n\n  useLayoutEffect(() => {\n    setWindowSize(window.innerWidth);\n  }, []);\n\n  useResize((w: number) => {\n    setWindowSize(w);\n  });\n\n  // 데이터\n  const { data } = props;\n  const [chartSortData, setChartSortData] = useState(data);\n  const dispatch = useAppDispatch();\n  const selectCountries = useAppSelector(\n    (state) => state.chartReducer.selectCountries,\n  );\n\n  useEffect(() => {\n    dispatch(sortData(chartSortData));\n    setChartSortData(chartSortData);\n  }, [dispatch, chartSortData]);\n\n  // 막대 그래프\n  const svgRef = useRef(null);\n  const tooltipRef = useRef(null);\n\n  // 컬러 설정\n  const xMax: number =\n    d3.max(chartSortData, (d) => d.population as number) ?? 0;\n  const colorScale = d3.scaleLinear().domain([0, xMax]).range([0.3, 1]);\n\n  const drawBarChart = useCallback(() => {\n    const svg = d3.select(svgRef.current);\n\n    // X스케일 설정\n    const xScale = d3\n      .scaleBand()\n      .domain(chartSortData.map((d) => d.translations.kor.common))\n      .range([margin.left, chartWidth])\n      .padding(0.2);\n\n    // Y스케일 설정\n    const yScale = d3\n      .scaleLinear()\n      .domain([0, xMax])\n      .range([chartHeight - margin.top - margin.bottom, margin.top])\n      .nice();\n\n    // Axis 만들기\n    const xAxis = d3.axisBottom(xScale).tickSizeOuter(0);\n\n    svg\n      .select<SVGSVGElement>(\".x_axis\")\n      .attr(\"transform\", `translate(0, ${chartHeight - margin.bottom})`)\n      .call(xAxis);\n    svg.select(\".x_axis\").selectAll(\".tick\").attr(\"width\", xScale.bandwidth());\n\n    const yAxis = d3\n      .axisLeft(yScale)\n      .ticks(chartSortData.length)\n      .tickSizeOuter(0);\n\n    svg\n      .select<SVGSVGElement>(\".y_axis\")\n      .attr(\"transform\", `translate(${margin.left}, ${margin.top})`)\n      .call(yAxis);\n\n    // 툴팁\n    const tooltip = d3.select(tooltipRef.current);\n\n    // 막대 그래프 그리기\n    svg.selectAll(\".bar_group\").remove();\n    svg\n      .append<SVGSVGElement>(\"g\")\n      .attr(\"class\", \"bar_group\")\n      .selectAll(\"rect\")\n      .data(chartSortData)\n      .enter()\n      .append<SVGRectElement>(\"rect\")\n      .attr(\"class\", \"bar\")\n      .attr(\"x\", (d) => xScale(d.translations.kor.common) as number)\n      .attr(\"y\", (d) => {\n        const height =\n          chartHeight - margin.bottom - margin.top - yScale(d.population);\n        return height > 2\n          ? yScale(d.population) + margin.top\n          : yScale(d.population) + margin.top - 2;\n      })\n      .attr(\"width\", xScale.bandwidth())\n      .attr(\"height\", (d) => {\n        const height =\n          chartHeight - margin.bottom - margin.top - yScale(d.population);\n        return height > 2 ? height : 2;\n      })\n      .style(\"fill\", (d) => d3.interpolateGnBu(colorScale(d.population)))\n      .on(\"mouseenter\", (e, d) => {\n        if (windowSize < 1000) return;\n        tooltip\n          .html(\n            `<p>국가 : ${\n              d.translations.kor.common\n            }</p><p>인구수 : ${d.population.toLocaleString()}명</p>`,\n          )\n          .transition()\n          .duration(200)\n          .style(\"opacity\", 1)\n          .style(\n            \"left\",\n            `${(xScale(d.translations.kor.common) as number) + xScale.bandwidth() + 5}px`,\n          )\n          .style(\"top\", `${yScale(d.population)}px`);\n        d3.select(e.target).transition().duration(200).style(\"opacity\", 0.6);\n      })\n      .on(\"mouseleave\", (e) => {\n        if (windowSize < 1000) return;\n        tooltip.style(\"opacity\", 0);\n        d3.select(e.target).transition().duration(50).style(\"opacity\", 1);\n      })\n      .transition()\n      .duration(500);\n  }, [\n    chartSortData,\n    colorScale,\n    xMax,\n    windowSize,\n    chartHeight,\n    chartWidth,\n    margin.bottom,\n    margin.left,\n    margin.top,\n  ]);\n  useEffect(() => {\n    setChartWidth(windowSize > 1000 ? 800 : windowSize * 0.9);\n    setChartHeight(windowSize > 1000 ? 500 : 350);\n\n    drawBarChart();\n  }, [windowSize, drawBarChart]);\n\n  return (\n    <motion.div\n      className=\"barchart_group\"\n      variants={BasicFade}\n      initial=\"hide\"\n      animate=\"show\"\n      custom={1}\n    >\n      <div className=\"barchart\">\n        {/* 그래프 */}\n        <svg ref={svgRef} width={chartWidth} height={chartHeight}>\n          <g className=\"x_axis\" />\n          <g className=\"y_axis\" />\n          <g className=\"bar_group\" />\n        </svg>\n        {/* // 그래프 */}\n\n        {/* 툴팁 */}\n        {windowSize > 1000 && <Tooltip ref={tooltipRef} />}\n        {/* // 툴팁 */}\n      </div>\n      {/* 레전드 */}\n      <ul className=\"bar_legend\">\n        {selectCountries.length > 0 &&\n          selectCountries.map((item: DataProps) => (\n            <li key={item.population}>\n              <svg className=\"color_table\" width={14} height={14}>\n                <rect\n                  className=\"color_table_rect\"\n                  width={14}\n                  height={14}\n                  fill={d3.interpolateGnBu(colorScale(item.population))}\n                />\n              </svg>\n              <p className=\"countries_name\">{item.translations.kor.common}</p>\n            </li>\n          ))}\n      </ul>\n      {/* // 레전드 */}\n    </motion.div>\n  );\n}\n","\"use client\";\n\nimport React, { useEffect } from \"react\";\n\nimport { motion } from \"framer-motion\";\nimport Link from \"next/link\";\n\nimport BarChart from \"@/components/chart/bar\";\nimport { DataProps } from \"@/types/chart\";\nimport { asyncCountries } from \"@modules/chartSlice\";\nimport { useAppDispatch, useAppSelector } from \"@modules/hooks\";\nimport { BasicFade } from \"@styles/motion\";\n\nexport default function Chart() {\n  const dispatch = useAppDispatch();\n\n  useEffect(() => {\n    dispatch(asyncCountries());\n  }, [dispatch]);\n\n  // 랜덤 국가 선택\n  const countriesSelect: number[] = [];\n  const countriesList: DataProps[] = [];\n  const count = 7;\n  const total = useAppSelector((state) => state.chartReducer.total);\n  const chartData = useAppSelector((state) => {\n    while (countriesSelect.length < count) {\n      const random: number = Math.floor(Math.random() * total);\n      countriesSelect.push(random);\n    }\n    if (countriesList.length < count) {\n      countriesSelect.map((num) =>\n        countriesList.push(state.chartReducer.countries[num]),\n      );\n    }\n    return countriesList;\n  });\n\n  return (\n    <>\n      <motion.h2\n        className=\"title\"\n        variants={BasicFade}\n        initial=\"hide\"\n        animate=\"show\"\n        custom={0.2}\n      >\n        Chart(D3.js)\n      </motion.h2>\n      <motion.p\n        className=\"title_desc\"\n        variants={BasicFade}\n        initial=\"hide\"\n        animate=\"show\"\n        custom={0.4}\n      >\n        {total}개의 국가 중에 {count}개 국가를 랜덤으로 데이터를 불러와 인구\n        수를 그래프로 그렸습니다.\n        <br />\n        그래프 바에 마우스를 올리면 정보가 표시됩니다.\n      </motion.p>\n      <motion.div\n        className=\"title_desc skill_point\"\n        variants={BasicFade}\n        initial=\"hide\"\n        animate=\"show\"\n        custom={0.4}\n      >\n        <p>\n          <b>핵심 기술</b>\n        </p>\n        <motion.ul\n          className=\"pill_group\"\n          variants={BasicFade}\n          initial=\"hide\"\n          animate=\"show\"\n          custom={0.6}\n        >\n          <motion.li>D3.js</motion.li>\n          <motion.li>SVG</motion.li>\n          <motion.li>반응형</motion.li>\n          <motion.li>styled-components</motion.li>\n          <motion.li>Redux</motion.li>\n          <motion.li>Redux-Toolkit</motion.li>\n          <motion.li>Typescript</motion.li>\n        </motion.ul>\n      </motion.div>\n      <motion.p\n        className=\"title_desc\"\n        variants={BasicFade}\n        initial=\"hide\"\n        animate=\"show\"\n        custom={0.6}\n      >\n        <b>데이터 출저</b>\n        <Link\n          href=\"https://restcountries.com\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          passHref\n          className=\"link\"\n        >\n          https://restcountries.com\n        </Link>\n      </motion.p>\n      <motion.p\n        className=\"title_desc\"\n        variants={BasicFade}\n        initial=\"hide\"\n        animate=\"show\"\n        custom={0.6}\n      >\n        <b>Github</b>\n        <Link\n          href=\"https://github.com/kkahub/kkaporfol/blob/main/src/components/chart/bar.tsx\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          passHref\n          className=\"link\"\n        >\n          코드 소스 보기\n        </Link>\n      </motion.p>\n\n      {chartData[0] !== undefined && <BarChart data={chartData} />}\n    </>\n  );\n}\n","import { useLayoutEffect } from \"react\";\r\n\r\nimport debounce from \"lodash/debounce\";\r\n\r\nexport default function useResize(callback: (w: number) => void) {\r\n  useLayoutEffect(() => {\r\n    const handleResize = debounce(() => {\r\n      const innerW = window.innerWidth;\r\n      callback(innerW);\r\n    }, 300);\r\n    window.addEventListener(\"resize\", handleResize);\r\n    return () => {\r\n      window.removeEventListener(\"resize\", handleResize);\r\n    };\r\n  });\r\n}\r\n","import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\n\ninterface CountriesThunk {\n  countries: never[];\n  selectCountries: never[];\n  total: number;\n  isLoading: string;\n  error: string | undefined | null;\n}\n\nconst initialState: CountriesThunk = {\n  countries: [],\n  selectCountries: [],\n  total: 0,\n  isLoading: \"false\",\n  error: null,\n};\n\n// thunk 생성\nexport const asyncCountries = createAsyncThunk(\n  \"chart/getCountries\",\n  async (payload, thunkAPI) => {\n    try {\n      const response = await axios.get(\n        \"https://restcountries.com/v3.1/all?fields=translations,population\",\n      );\n      return thunkAPI.fulfillWithValue(response.data);\n    } catch (error) {\n      return thunkAPI.rejectWithValue(error);\n    }\n  },\n);\n\n// 리듀서\nconst chartSlice = createSlice({\n  name: \"chart\",\n  initialState,\n  reducers: {\n    setData: (state, action) => ({\n      ...state,\n      countries: action.payload,\n    }),\n    sortData: (state, action) => ({\n      ...state,\n      selectCountries: action.payload,\n    }),\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(asyncCountries.pending, (state) => {\n        // eslint-disable-next-line no-param-reassign\n        state.isLoading = \"pending\";\n      })\n      .addCase(asyncCountries.fulfilled, (state, action) => {\n        // eslint-disable-next-line no-param-reassign\n        state.isLoading = \"fulfilled\";\n        // eslint-disable-next-line no-param-reassign\n        state.countries = action.payload;\n        // eslint-disable-next-line no-param-reassign\n        state.total = action.payload.length;\n      })\n      .addCase(asyncCountries.rejected, (state, action) => {\n        // eslint-disable-next-line no-param-reassign\n        state.isLoading = \"rejected\";\n        // eslint-disable-next-line no-param-reassign\n        state.error = action.error.message;\n      });\n  },\n});\n\nexport const chart = chartSlice.name;\nexport const { setData, sortData } = chartSlice.actions;\nexport const chartReducer = chartSlice.reducer;\nexport default chartSlice;\n","import { TypedUseSelectorHook, useDispatch, useSelector } from \"react-redux\";\r\n\r\nimport type { RootState, AppDispatch } from \"@modules/store\";\r\n\r\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\r\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\r\n"],"names":["BasicFade","show","opacity","transition","delay","i","duration","hide","Tooltip","style","div","BarChart","props","d3","windowSize","margin","useState","window","innerWidth","chartWidth","setChartWidth","chartHeight","setChartHeight","useLayoutEffect","setWindowSize","useResize","w","data","chartSortData","setChartSortData","dispatch","useAppDispatch","selectCountries","useAppSelector","state","chartReducer","useEffect","sortData","svgRef","useRef","tooltipRef","xMax","d","population","colorScale","domain","range","drawBarChart","useCallback","svg","current","xScale","map","translations","kor","common","padding","yScale","nice","xAxis","top","tickSizeOuter","bottom","select","attr","call","selectAll","bandwidth","yAxis","ticks","length","left","tooltip","remove","append","enter","height","on","e","html","toLocaleString","target","motion","className","variants","initial","animate","custom","ref","width","g","ul","li","rect","fill","item","p","Chart","asyncCountries","countriesSelect","countriesList","total","chartData","count","random","Math","floor","push","countries","num","h2","br","b","Link","href","rel","passHref","undefined","callback","handleResize","debounce","addEventListener","removeEventListener","createAsyncThunk","payload","thunkAPI","response","axios","get","fulfillWithValue","error","rejectWithValue","createSlice","name","initialState","isLoading","reducers","setData","action","extraReducers","builder","addCase","pending","fulfilled","rejected","message","chartSlice","actions","reducer","useDispatch","useSelector"],"sourceRoot":"","ignoreList":[]}